<!DOCTYPE html> 
<html>
<head>
<meta charset="utf-8">
<title>Colecciones</title>
<link rel="stylesheet" href="jquery-mobile/jquery.mobile-1.4.5.min.css">
	<script src="jquery-mobile/jquery.js"></script>
	<script src="jquery-mobile/jquery.mobile-1.4.5.min.js"></script>
	<script type="text/javascript" charset="utf-8">
		var usuario = window.localStorage.getItem("nombreUsuario");
		//traerColecciones();
		
		function toFeedPrincipal(){
			window.location="FeedPrincipalLector.html";
		}
		
		function guardarColeccion(){
			alert("Prueba con usuario en session: "+usuario);
			var coleccionName = $('#nombreColeccion').val();
			
			$.post('http://127.0.0.1:8080/LookDocs/controller/lookDocs/crearColeccion',{correo:usuario,nombreColeccion:coleccionName},function(retorno){
			if (retorno=="exito") {
				alert("Se ha guardado la colección " +coleccionName);
				$('#nombreColeccion').val("");
			}else{
				alert(retorno);
			};
			});
		}
		
		function traerColecciones(){
			$.get('http://127.0.0.1:8080/LookDocs/controller/lookDocs/obtenercolecciones',{mail:usuario},function(data){
			if (data==null) {
				alert("El usuario no tiene colecciones");
			}else{
				$('#listaColecciones').empty().append('<option value="0">Seleccione una Colección</option>').find('option:first').attr("selected","selected");
				alert(data.items);
				if(data.items!=null){
				alert("entró");
				//Inserta los valores recuperados en la lista desplegable
				$.each(data.items, function(i, value) {
				$('#listaColecciones').append('<option value='+value.codigoCole+'>'+value.nombre+'</option>');
				});}else{alert("no entró");}
				//Actualiza la lista desplegable
				$('#listaColecciones').selectmenu("refresh", true);
			};
			});
		}
	</script>
</head> 
<body>
<div data-role="page" id="page">
  <div data-role="header" data-theme="b">
    <h1>Colecciones</h1>
     <a onclick="toFeedPrincipal()" data-icon="arrow-l"  data-rel="close" data-iconpos="notext">Regresar</a>
  </div>
	<div data-role="collapsible" data-theme="b">
		<h4>Crear Colección</h4>
			<label for="nombreColeccion">Ingresa un nombre para la nueva colección: *</label>
			<input  id="nombreColeccion" type="text" name="nombreColeccion" value=""  />
			<a onclick="guardarColeccion()"  data-role="button">Guardar Colección</a>
	</div>
	<div data-role="collapsible" data-theme="b">
		<h4 onclick="traerColecciones()">Modificar Colección</h4>
			<select name="listaColecciones" id="listaColecciones">
			</select>
	</div>
	<div data-role="collapsible" data-theme="b">
		<h4>Eliminar Colección</h4>
			Lista Coleccion...
	</div>
	  
	  
    
  	
    


  
</div>

</body>
</html>
